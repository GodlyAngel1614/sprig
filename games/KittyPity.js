/*
First time? Check out the tutorial game:
https://sprig.hackclub.com/gallery/getting_started

@title: KittyPity
@author: 
@tags: []
@addedOn: 2024-00-00
*/

// Sprites
const player = "p"
const Goal = "t"
const box = "B"
const Maze = "G"
const Enemy = "E"

//Tunes And General

const level3 = tune`
410.958904109589: B5^410.958904109589,
410.958904109589: B5^410.958904109589,
410.958904109589: B5^410.958904109589,
410.958904109589: E5~410.958904109589,
410.958904109589: F5~410.958904109589,
410.958904109589: G5~410.958904109589,
410.958904109589: F5~410.958904109589 + B5~410.958904109589,
410.958904109589: A5~410.958904109589 + C5^410.958904109589,
410.958904109589: G5~410.958904109589 + B4^410.958904109589,
410.958904109589: F5~410.958904109589 + B5~410.958904109589 + C5^410.958904109589 + A4^410.958904109589,
410.958904109589: G5-410.958904109589,
410.958904109589: A5-410.958904109589 + B4^410.958904109589,
410.958904109589: G5-410.958904109589 + C5^410.958904109589 + A4^410.958904109589,
410.958904109589: E5~410.958904109589 + B4^410.958904109589,
410.958904109589: D5~410.958904109589 + A5-410.958904109589,
410.958904109589: E5~410.958904109589 + C5^410.958904109589,
410.958904109589: F5-410.958904109589 + B4^410.958904109589,
410.958904109589: G5-410.958904109589 + F5^410.958904109589 + C5^410.958904109589 + A4^410.958904109589,
410.958904109589: F5-410.958904109589 + A5~410.958904109589,
410.958904109589: E5-410.958904109589 + B5-410.958904109589 + G5-410.958904109589,
410.958904109589: C5-410.958904109589 + A5~410.958904109589,
410.958904109589: E5~410.958904109589,
410.958904109589: F5~410.958904109589 + A4^410.958904109589,
410.958904109589: G5~410.958904109589 + B4^410.958904109589,
410.958904109589: E5~410.958904109589 + A4^410.958904109589 + C5^410.958904109589,
410.958904109589: E5-410.958904109589 + B4^410.958904109589,
410.958904109589: D5-410.958904109589 + A4^410.958904109589 + F4-410.958904109589,
410.958904109589: C5-410.958904109589 + F5~410.958904109589 + D5^410.958904109589 + G4-410.958904109589 + E4-410.958904109589,
410.958904109589: D5-410.958904109589 + B4^410.958904109589 + A5~410.958904109589 + F4-410.958904109589,
410.958904109589: G5-410.958904109589 + C5^410.958904109589 + A4^410.958904109589 + B5^410.958904109589 + E4~410.958904109589,
410.958904109589: B4^410.958904109589 + G5~410.958904109589 + B5~410.958904109589,
410.958904109589: A5^410.958904109589`
const Undo = tune`
192.30769230769232,
192.30769230769232: D4^192.30769230769232 + A5~192.30769230769232,
192.30769230769232: E4^192.30769230769232 + G5~192.30769230769232 + A5-192.30769230769232 + D4/192.30769230769232,
192.30769230769232: F4^192.30769230769232 + F5~192.30769230769232 + A5-192.30769230769232 + D4/192.30769230769232,
192.30769230769232: G4^192.30769230769232 + E5~192.30769230769232 + A5-192.30769230769232 + D4/192.30769230769232,
192.30769230769232: A4^192.30769230769232 + D5~192.30769230769232 + A5-192.30769230769232,
192.30769230769232: B4^192.30769230769232 + C5~192.30769230769232,
192.30769230769232: A4-192.30769230769232 + D5/192.30769230769232 + D4~192.30769230769232,
192.30769230769232: G4-192.30769230769232 + E5/192.30769230769232 + A5^192.30769230769232 + D4~192.30769230769232,
192.30769230769232: F4-192.30769230769232 + F5/192.30769230769232 + A5^192.30769230769232 + D4~192.30769230769232,
192.30769230769232: E4-192.30769230769232 + G5/192.30769230769232 + A5^192.30769230769232 + D4~192.30769230769232,
192.30769230769232: D4-192.30769230769232 + A5/192.30769230769232,
192.30769230769232: A5^192.30769230769232 + G5~192.30769230769232 + F5~192.30769230769232 + E5~192.30769230769232 + C5~192.30769230769232,
192.30769230769232: G5^192.30769230769232 + A5-192.30769230769232 + E5~192.30769230769232 + D5~192.30769230769232 + C5~192.30769230769232,
192.30769230769232: F5^192.30769230769232 + G5-192.30769230769232 + A4^192.30769230769232 + B4^192.30769230769232 + G4^192.30769230769232,
192.30769230769232: E5^192.30769230769232 + F5-192.30769230769232 + F4^192.30769230769232 + D4^192.30769230769232,
192.30769230769232: D5^192.30769230769232 + E5-192.30769230769232 + F4^192.30769230769232 + E4^192.30769230769232 + D4^192.30769230769232,
192.30769230769232: C5^192.30769230769232 + D5-192.30769230769232 + A4-192.30769230769232 + B4-192.30769230769232,
192.30769230769232: G4-192.30769230769232 + F4-192.30769230769232 + A4-192.30769230769232 + C5-192.30769230769232 + B4^192.30769230769232,
192.30769230769232: B4~192.30769230769232 + C5~192.30769230769232 + A4~192.30769230769232,
192.30769230769232: D5^192.30769230769232 + C5-192.30769230769232,
192.30769230769232: E5^192.30769230769232 + B4-192.30769230769232 + E4-192.30769230769232,
192.30769230769232: G5^192.30769230769232 + F5^192.30769230769232 + A4-192.30769230769232,
192.30769230769232: E5^192.30769230769232 + A4-192.30769230769232 + D4-192.30769230769232,
192.30769230769232: D5^192.30769230769232 + B4-192.30769230769232,
192.30769230769232: C5^192.30769230769232 + B4-192.30769230769232,
192.30769230769232: D5^192.30769230769232 + A4-192.30769230769232 + B4^192.30769230769232,
192.30769230769232: E5^192.30769230769232 + B4-192.30769230769232 + E4-192.30769230769232,
192.30769230769232: F5^192.30769230769232 + B4-192.30769230769232,
192.30769230769232: G5^192.30769230769232 + E4-192.30769230769232,
384.61538461538464`
const Wall = 'W'

// Walks

const step1 = tune`
192.30769230769232: C4~192.30769230769232,
5961.538461538462`
const step2 = tune`
192.30769230769232: B5~192.30769230769232,
5961.538461538462`
const step3 = tune`
200: B5^200,
6200`
const step4 = tune`
185.1851851851852: B5^185.1851851851852,
5740.740740740741`

//Level 3
const Sun = "s"
const nighttime = "n"
const grass = "g"



// ImportantVariable
var current = 0

setLegend(
  [ player, bitmap`
................
................
....LL000000....
....LL064640....
....LL064640....
....LL066660....
....LL000000....
.....L00660.....
.....L00660.....
.....L00000.....
.....LLLLL......
................
................
................
................
................`],
  [box, bitmap`
................
................
................
........000.....
.....000000.....
....00000000....
....00003030....
....00003030....
....00003000....
....00003000....
....00000000....
....00000000....
................
................
................
................`],
  [Goal, bitmap`
................
...00000........
...93390........
...93390........
...90090........
...00000........
...00000........
................
................
................
................
................
................
................
................
................
................`],
  [Wall, bitmap`
0007077070000007
0000000000000777
0000070000007700
0000070077770707
0000077770000077
0000000000000007
0000000000000000
0000000000000000
0000000000000000
0000000000777000
0000007770777000
0000777770777000
0000077770000000
0000000000000000
0000000000000000
0000000000000000`],

  [Sun, bitmap`
..........000000
..........062260
..........062260
..........001100
............13..
................
................
................
................
................
................
................
................
................
................
................`],
  [nighttime, bitmap`
0555555555555577
0555555555555555
0577757775555757
0777777777777777
0555555555555555
0555555555555555
0777555555555555
0777777777777777
0777777777777777
0555555555555555
0775777777777777
0777777777755557
0777777555555555
0555557555555555
0777755577777777
0555555555555555`],
  [grass, bitmap`
................
................
................
................
................
................
................
................
................
................
................
................
................
................
FFDDFDDDFFDDDFFF
FFFFFFFFFDDFFFDF`],
  [Enemy, bitmap`
................
................
................
................
.....000000.....
.....0L2L00.....
.....0L2L00.....
...0002220000...
...0222222200...
...0222222200...
...0202220200...
...0202220200...
...0000000000...
.....020200.....
.....020200.....
.....000000.....`],
    [Maze, bitmap`
0000000000000000
0000000000000000
0000000000000000
0000000000000000
0000000000000000
0000000000000000
0000000000000000
0000000000000000
0000000000000000
0000000000000000
0000000000000000
0000000000000000
0000000000000000
0000000000000000
0000000000000000
0000000000000000`],
);

let level = 0;

const levels = [
   map`
....
....
....`,
  map`
WG...
W..B.
WW.p.`,
  map`
WWWWW
BBp.W
GB..W
BWWWW`,
  map`
nnns
ngBp
nnng`,
   map`
GGGG.t
G.G..E
p...GG
.B..EG
.G.G.G
GGGGGG`,
 ];

// Main Menu

 addText("Press K to play!", {x:4, y:4, color: color`1`});

////

const currentLevel = levels[level];
setMap(currentLevel);

setSolids([ player, box, nighttime, Sun, Wall, Maze, Enemy]);

setPushables({
  [ player ]: [box]
});

function StartGame() {
if (level == 0 ) {
   
  }

  else {
    return false;
  }
}

function EnemyMove() {
  if (level == 5) {
     setTimeout(() => {
  
   }, 300)

  const distance = (Enemy, player.length);

  while (distance >= 1) {
    Enemy.x - Player.x + 2;
  }
}
}

// Main Menu

  setTimeout(() => {
   onInput("k", () => {
    StartGame()
     playTune(level3)
  });
      clearText()
   }, 800)
////

onInput("s", () => {
  getFirst(player).y +=1
  playTune(step1, 1)
});

onInput("w", () => {
  getFirst(player).y -= 1
  playTune(step2, 1)
});

onInput("a", () => {
  getFirst(player).x -= 1
  playTune(step3, 1)
});

onInput("d", () => {
  getFirst(player).x +=1
  playTune(step4, 1)
});



afterInput(() => {
  const targetfound = tilesWith(Goal).length;
  const NumberCovered = tilesWith(Goal, box).length;
   const grassfall = tilesWith(box).length;
    const Covered = tilesWith(box, grass).length;


  // Starting the game!
  
  if (NumberCovered == targetfound) {
    level += 1 
    current += 1;

    EnemyMove()

    const currentLevel = levels[level];

    if (currentLevel !== undefined) {
      setMap(currentLevel);
    }
  }
  
if (grassfall == Covered) {
if (levels == 3) {
  setTimeout(() => {
       addText("You died.", {x:5, y:4, color: color`1`});
   }, 3000)
   
    setMap(levels[3]);
  }
}

  setTimeout(() => {
      clearText()
   }, 3000)
    
           
});